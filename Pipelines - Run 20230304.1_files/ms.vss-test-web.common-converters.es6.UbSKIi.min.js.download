"use strict";define("Test/common-converters",["require","exports","Test/common-util/Common","Test/common-util/Common.Utils","VSSUI/Utilities/Date"],(function(e,t,n,i,r){var a;a=t.Resources={},t.Resources.CurrentRelease="Current release",t.Resources.CurrentBuild="Current build",function(e){function s(e,t){return e===t.failingSince.build.id?a.CurrentBuild:t.failingSince.build.number}function o(e,t){return e===t.failingSince.release.id?a.CurrentRelease:t.failingSince.release.name}function u(e){let t="";return e&&e.data.subData&&(t=e.data.subData.environment.name),t}function d(e,t,n){return e=e||0,t=t||0,n?e-t:t-e}t.TestResultConverter={},t.TestResultConverter.getResultViewModelFromTestResult=function(e,t,a){let d=0,l="",c=t,m=!1;if(e.failingSince&&c)switch(c.viewContext){case n.ViewContext.Build:d=e.failingSince.build?e.failingSince.build.id:0,l=s(c.data.mainData.id,e),m=c.data.mainData.id===e.failingSince.build.id;break;case n.ViewContext.Release:d=e.failingSince.release?e.failingSince.release.id:0,l=o(c.data.mainData.id,e),m=c.data.mainData.id===e.failingSince.release.id}return{test:e.testCaseTitle,testTitle:e.automatedTestName,storage:e.automatedTestStorage||"",failingSince:e.failingSince?(0,r.ago)(e.failingSince.date):"",failingContextName:l,isNewFailure:!!e.failingSince&&c.data.mainData.id===e.failingSince.build.id,runId:parseInt(e.testRun.id),resultId:e.id,testcaseObject:e.testCase,testCaseRefId:e.testCaseReferenceId,failingContextId:d,isTestCaseRow:!0,expanded:!1,outcome:n.TestOutcomeEnum[e.outcome],duration:e.durationInMs?i.TCMContractsConverter.ConvertMilliSecondsToReadableFormatForResultSummary(e.durationInMs):i.TCMContractsConverter.ConvertMilliSecondsToReadableFormatForResultSummary(0),durationInMs:e.durationInMs?e.durationInMs:0,dateStarted:e.startedDate?e.startedDate.toLocaleString():"",dateCompleted:e.completedDate?e.completedDate.toLocaleString():"",owner:e.owner?e.owner.displayName:"",parentGroupId:a,subresults:e.subResults,groupId:e.testRun.id.toString()+"."+e.id.toString(),nodeType:null!=e.resultGroupType&&0!==e.resultGroupType?2:1,environmentName:e.releaseReference?u(c):"",isSubResultRow:!1,isCurrentArtifact:m}},t.TestResultConverter.getRunViewModelFromTestRun=function(e,t){return{test:e.name,isTestCaseRow:!1,duration:"-",testTitle:e.name,runId:e.id,expanded:!1,parentGroupId:"-1",groupId:"",nodeType:2}},t.TestResultConverter.getFailingSinceBuildString=s,t.TestResultConverter.getFailingSinceReleaseString=o,t.TestResultConverter.getEnvironmentName=u,t.TestResultConverter.sortDuration=d,t.TestResultConverter.sortingIdentifierAscending=function(e,t){return d(e.durationInMs,t.durationInMs,!0)},t.TestResultConverter.sortingIdentifierDescending=function(e,t){return d(e.durationInMs,t.durationInMs,!1)},t.TestResultConverter.sortingComparatorAscending=function(e,t){return d(e.durationInMs,t.durationInMs,!0)},t.TestResultConverter.sortingComparatorDescending=function(e,t){return d(e.durationInMs,t.durationInMs,!1)},t.TestResultConverter.sortingTestTreeDataComparerDescending=function(e,t){return d(e.durationInMs?e.durationInMs:0,t.durationInMs?t.durationInMs:0,!1)},t.TestResultConverter.sortingTestTreeDataComparerAscending=function(e,t){return d(e.durationInMs?e.durationInMs:0,t.durationInMs?t.durationInMs:0,!0)}}()}),["Resources","TestResultConverter"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-test-web.common-converters"}}));